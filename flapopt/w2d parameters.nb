(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     59208,       1495]
NotebookOptionsPosition[     55926,       1429]
NotebookOutlinePosition[     56300,       1445]
CellTagsIndexPosition[     56257,       1442]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"dq", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T", " ", "d\[Sigma]a"}], ",", "d\[Psi]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddq", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T", " ", "dd\[Sigma]a"}], ",", "dd\[Psi]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Iw", "=", 
   RowBox[{"mw", " ", 
    RowBox[{"cb", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mw", ",", 
       RowBox[{"cb", " ", "mw", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cb", " ", "mw", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{"Iw", "+", 
        RowBox[{
         RowBox[{"cb", "^", "2"}], "mw"}]}]}], "}"}]}], "}"}]}], ";", 
  RowBox[{"Cc", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "cb"}], " ", "mw", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}], "d\[Psi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k\[Sigma]", " ", 
      RowBox[{"(", 
       RowBox[{"T", " ", "\[Sigma]a"}], ")"}]}], ",", 
     RowBox[{"k\[Psi]", " ", "\[Psi]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"lhs", "=", 
  RowBox[{
   RowBox[{"M", ".", "ddq"}], "+", 
   RowBox[{"Cc", ".", "dq"}], "+", "gg"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"{", 
    RowBox[{"cb", ",", "T"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"lhs", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Dlp", "=", 
    RowBox[{"D", "[", 
     RowBox[{"lhs", ",", 
      RowBox[{"{", "p", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lhs", "-", 
    RowBox[{"(", 
     RowBox[{"Dlp", ".", "p"}], ")"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Did", " ", "this", " ", "by", " ", "hand", " ", "TODO", " ", "automate", 
    " ", "this", " ", "somehow"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Htest", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"dd\[Sigma]a", 
         RowBox[{"(", 
          RowBox[{"ms", "+", "mw"}], ")"}]}], "+", 
        RowBox[{"k\[Sigma]", " ", "\[Sigma]a"}]}], ",", 
       RowBox[{"mw", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dd\[Psi]", " ", 
           RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "-", 
          RowBox[{
           RowBox[{"d\[Psi]", "^", "2"}], 
           RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ")"}]}], ",", "0", ",", 
       "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"k\[Psi]", " ", "\[Psi]"}], "+", 
        RowBox[{"Iw", " ", "dd\[Psi]"}]}], ",", "0", ",", "0", ",", 
       RowBox[{"mw", " ", "dd\[Sigma]a", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{"mw", " ", "dd\[Psi]"}]}], "}"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Htest", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "T", ",", "cb", ",", 
     RowBox[{"cb", " ", "T"}], ",", 
     RowBox[{"cb", "^", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lhs", "-", 
   RowBox[{"Htest", ".", "pb"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7771425365648155`*^9, 3.7771426203092065`*^9}, {
   3.777142749924432*^9, 3.777142907520192*^9}, {3.777143613426916*^9, 
   3.7771436469442883`*^9}, {3.777144427755089*^9, 3.7771444483754*^9}, {
   3.777284995631071*^9, 3.7772850397329283`*^9}, {3.7772850749962263`*^9, 
   3.7772851127909656`*^9}, {3.777285157266591*^9, 3.777285274992138*^9}, {
   3.777285317015274*^9, 3.7772853713068604`*^9}, {3.7772854163541384`*^9, 
   3.7772854731521792`*^9}, {3.7772864914658566`*^9, 3.777286503883217*^9}, {
   3.777295819230338*^9, 3.7772958382176557`*^9}, {3.7772958812651596`*^9, 
   3.7772958961290135`*^9}, {3.777295954661989*^9, 3.7772959615397563`*^9}, 
   3.7779802136579175`*^9, {3.7779802489005823`*^9, 3.7779802630151763`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"6b59dfce-cc25-4d57-9081-6bccd44f02c9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"dd\[Sigma]a", " ", "mw", " ", "T"}], "+", 
    RowBox[{"k\[Sigma]", " ", "T", " ", "\[Sigma]a"}], "+", 
    RowBox[{"cb", " ", "dd\[Psi]", " ", "mw", " ", 
     RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "-", 
    RowBox[{"cb", " ", 
     SuperscriptBox["d\[Psi]", "2"], " ", "mw", " ", 
     RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox["cb", "2"], " ", "dd\[Psi]", " ", "mw"}], "+", 
    RowBox[{"k\[Psi]", " ", "\[Psi]"}], "+", 
    RowBox[{"cb", " ", "dd\[Sigma]a", " ", "mw", " ", "T", " ", 
     RowBox[{"Cos", "[", "\[Psi]", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7771426208029013`*^9, {3.7771427899497986`*^9, 3.7771428476120634`*^9}, {
   3.777142884946085*^9, 3.7771429078619814`*^9}, {3.777143613763706*^9, 
   3.777143647333047*^9}, {3.777144428099878*^9, 3.777144448681212*^9}, 
   3.7772849930646515`*^9, {3.77728516055157*^9, 3.777285187980688*^9}, {
   3.777285248590386*^9, 3.777285276126438*^9}, 3.7772853173820496`*^9, 
   3.7772853721033688`*^9, {3.777285436356827*^9, 3.7772854734969654`*^9}, 
   3.7772865042130117`*^9, 3.777295896374861*^9, 3.777295962124394*^9, 
   3.77731078907687*^9, 3.7773973266233587`*^9, 3.7778365749719067`*^9, 
   3.77790210778614*^9, 3.7779801032053537`*^9, 3.7779802644718494`*^9, {
   3.7782417810458937`*^9, 3.778241785827381*^9}},
 CellLabel->"Out[29]=",ExpressionUUID->"07e5fb6f-3e52-4dc9-92d6-fb57031d60a8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"dd\[Sigma]a", " ", "mw", " ", "T"}], "+", 
        RowBox[{"k\[Sigma]", " ", "T", " ", "\[Sigma]a"}], "+", 
        RowBox[{"cb", " ", "dd\[Psi]", " ", "mw", " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "-", 
        RowBox[{"cb", " ", 
         SuperscriptBox["d\[Psi]", "2"], " ", "mw", " ", 
         RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["cb", "2"], " ", "dd\[Psi]", " ", "mw"}], "+", 
        RowBox[{"k\[Psi]", " ", "\[Psi]"}], "+", 
        RowBox[{"cb", " ", "dd\[Sigma]a", " ", "mw", " ", "T", " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7771426208029013`*^9, {3.7771427899497986`*^9, 3.7771428476120634`*^9}, {
   3.777142884946085*^9, 3.7771429078619814`*^9}, {3.777143613763706*^9, 
   3.777143647333047*^9}, {3.777144428099878*^9, 3.777144448681212*^9}, 
   3.7772849930646515`*^9, {3.77728516055157*^9, 3.777285187980688*^9}, {
   3.777285248590386*^9, 3.777285276126438*^9}, 3.7772853173820496`*^9, 
   3.7772853721033688`*^9, {3.777285436356827*^9, 3.7772854734969654`*^9}, 
   3.7772865042130117`*^9, 3.777295896374861*^9, 3.777295962124394*^9, 
   3.77731078907687*^9, 3.7773973266233587`*^9, 3.7778365749719067`*^9, 
   3.77790210778614*^9, 3.7779801032053537`*^9, 3.7779802644718494`*^9, {
   3.7782417810458937`*^9, 3.7782417858430095`*^9}},
 CellLabel->
  "Out[31]//MatrixForm=",ExpressionUUID->"50f5c4bc-98b0-4ab3-9994-\
6f8594724e57"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"dd\[Psi]", " ", "mw", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["d\[Psi]", "2"], " ", "mw", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"dd\[Sigma]a", " ", "mw"}], "+", 
       RowBox[{"k\[Sigma]", " ", "\[Sigma]a"}]}]},
     {
      RowBox[{
       RowBox[{"4", " ", "cb", " ", "dd\[Psi]", " ", "mw"}], "+", 
       RowBox[{"dd\[Sigma]a", " ", "mw", " ", "T", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{"cb", " ", "dd\[Sigma]a", " ", "mw", " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7771426208029013`*^9, {3.7771427899497986`*^9, 3.7771428476120634`*^9}, {
   3.777142884946085*^9, 3.7771429078619814`*^9}, {3.777143613763706*^9, 
   3.777143647333047*^9}, {3.777144428099878*^9, 3.777144448681212*^9}, 
   3.7772849930646515`*^9, {3.77728516055157*^9, 3.777285187980688*^9}, {
   3.777285248590386*^9, 3.777285276126438*^9}, 3.7772853173820496`*^9, 
   3.7772853721033688`*^9, {3.777285436356827*^9, 3.7772854734969654`*^9}, 
   3.7772865042130117`*^9, 3.777295896374861*^9, 3.777295962124394*^9, 
   3.77731078907687*^9, 3.7773973266233587`*^9, 3.7778365749719067`*^9, 
   3.77790210778614*^9, 3.7779801032053537`*^9, 3.7779802644718494`*^9, {
   3.7782417810458937`*^9, 3.7782417858430095`*^9}},
 CellLabel->
  "Out[32]//MatrixForm=",ExpressionUUID->"121a8581-f272-4763-a9d5-\
d4f1dc1ae726"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["cb", "2"], " ", "dd\[Psi]", " ", "mw"}], "+", 
    RowBox[{"k\[Psi]", " ", "\[Psi]"}], "-", 
    RowBox[{"cb", " ", "dd\[Sigma]a", " ", "mw", " ", "T", " ", 
     RowBox[{"Cos", "[", "\[Psi]", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7771426208029013`*^9, {3.7771427899497986`*^9, 3.7771428476120634`*^9}, {
   3.777142884946085*^9, 3.7771429078619814`*^9}, {3.777143613763706*^9, 
   3.777143647333047*^9}, {3.777144428099878*^9, 3.777144448681212*^9}, 
   3.7772849930646515`*^9, {3.77728516055157*^9, 3.777285187980688*^9}, {
   3.777285248590386*^9, 3.777285276126438*^9}, 3.7772853173820496`*^9, 
   3.7772853721033688`*^9, {3.777285436356827*^9, 3.7772854734969654`*^9}, 
   3.7772865042130117`*^9, 3.777295896374861*^9, 3.777295962124394*^9, 
   3.77731078907687*^9, 3.7773973266233587`*^9, 3.7778365749719067`*^9, 
   3.77790210778614*^9, 3.7779801032053537`*^9, 3.7779802644718494`*^9, {
   3.7782417810458937`*^9, 3.7782417858430095`*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"840940f6-5b46-4579-b253-cd5aedaa062e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{
       RowBox[{"dd\[Sigma]a", " ", 
        RowBox[{"(", 
         RowBox[{"ms", "+", "mw"}], ")"}]}], "+", 
       RowBox[{"k\[Sigma]", " ", "\[Sigma]a"}]}], 
      RowBox[{"mw", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dd\[Psi]", " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["d\[Psi]", "2"], " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ")"}]}], "0", "0"},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["cb", "2"], " ", "dd\[Psi]", " ", "mw"}], "+", 
       RowBox[{"k\[Psi]", " ", "\[Psi]"}]}], "0", "0", 
      RowBox[{"dd\[Sigma]a", " ", "mw", " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], 
      RowBox[{"dd\[Psi]", " ", "mw"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7771426208029013`*^9, {3.7771427899497986`*^9, 3.7771428476120634`*^9}, {
   3.777142884946085*^9, 3.7771429078619814`*^9}, {3.777143613763706*^9, 
   3.777143647333047*^9}, {3.777144428099878*^9, 3.777144448681212*^9}, 
   3.7772849930646515`*^9, {3.77728516055157*^9, 3.777285187980688*^9}, {
   3.777285248590386*^9, 3.777285276126438*^9}, 3.7772853173820496`*^9, 
   3.7772853721033688`*^9, {3.777285436356827*^9, 3.7772854734969654`*^9}, 
   3.7772865042130117`*^9, 3.777295896374861*^9, 3.777295962124394*^9, 
   3.77731078907687*^9, 3.7773973266233587`*^9, 3.7778365749719067`*^9, 
   3.77790210778614*^9, 3.7779801032053537`*^9, 3.7779802644718494`*^9, {
   3.7782417810458937`*^9, 3.77824178585863*^9}},
 CellLabel->
  "Out[35]//MatrixForm=",ExpressionUUID->"f365aae1-697a-4973-b770-\
ba0d2cec8ef5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "dd\[Sigma]a"}], " ", "ms", " ", "T"}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7771426208029013`*^9, {3.7771427899497986`*^9, 3.7771428476120634`*^9}, {
   3.777142884946085*^9, 3.7771429078619814`*^9}, {3.777143613763706*^9, 
   3.777143647333047*^9}, {3.777144428099878*^9, 3.777144448681212*^9}, 
   3.7772849930646515`*^9, {3.77728516055157*^9, 3.777285187980688*^9}, {
   3.777285248590386*^9, 3.777285276126438*^9}, 3.7772853173820496`*^9, 
   3.7772853721033688`*^9, {3.777285436356827*^9, 3.7772854734969654`*^9}, 
   3.7772865042130117`*^9, 3.777295896374861*^9, 3.777295962124394*^9, 
   3.77731078907687*^9, 3.7773973266233587`*^9, 3.7778365749719067`*^9, 
   3.77790210778614*^9, 3.7779801032053537`*^9, 3.7779802644718494`*^9, {
   3.7782417810458937`*^9, 3.77824178585863*^9}},
 CellLabel->"Out[37]=",ExpressionUUID->"dd5e1ef8-539b-41f0-9e50-61f5227a2c69"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"pieces", " ", "from", " ", "notes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Mdq", "=", 
     RowBox[{"M", ".", "dq"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HMq", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"d\[Sigma]a", " ", 
          RowBox[{"(", "mw", ")"}]}], ",", 
         RowBox[{"d\[Psi]", " ", "mw", " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", "0", ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d\[Psi]", " ", "Iw"}], ",", "0", ",", "0", ",", 
         RowBox[{"d\[Sigma]a", " ", "mw", " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
         RowBox[{"d\[Psi]", " ", "mw"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<HMq =\>\"", ",", 
     RowBox[{"HMq", "//", "MatrixForm"}], ",", "\"\< check \>\"", ",", 
     RowBox[{
      RowBox[{"Mdq", "-", 
       RowBox[{"HMq", ".", "pb"}]}], "//", "Simplify"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CgJ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cc", "\[Transpose]"}], "-", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{"b\[Sigma]", ",", "b\[Psi]"}], "}"}], "]"}]}], ")"}], ".", 
       "dq"}], "-", "gg"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"MISSING", " ", "J", " ", "F"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HCgJ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "k\[Sigma]"}], " ", "\[Sigma]a"}], "-", 
          RowBox[{"b\[Sigma]", " ", "d\[Sigma]a"}]}], ",", "0", ",", "0", ",",
          "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "k\[Psi]"}], " ", "\[Psi]"}], "-", 
          RowBox[{"b\[Psi]", " ", "d\[Psi]"}]}], ",", "0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", " ", "d\[Sigma]a"}], " ", "d\[Psi]", " ", "mw", " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", "0"}], "}"}]}], "}"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<HCgJ =\>\"", ",", 
     RowBox[{"HCgJ", "//", "MatrixForm"}], ",", "\"\< check \>\"", ",", 
     RowBox[{
      RowBox[{"CgJ", "-", 
       RowBox[{"HCgJ", ".", "pb"}]}], "//", "Simplify"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7772955427659225`*^9, 3.7772958056986694`*^9}, {
   3.7772958754757233`*^9, 3.77729587603638*^9}, {3.777295978618245*^9, 
   3.7772960974970765`*^9}, {3.777311351287094*^9, 3.7773114630201364`*^9}, 
   3.777980271056014*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"e907f1af-bbb5-418e-9307-0e8120f51a63"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"HMq =\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"d\[Sigma]a", " ", "mw"}], 
        RowBox[{"d\[Psi]", " ", "mw", " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "0", "0"},
       {
        RowBox[{
         SuperscriptBox["cb", "2"], " ", "d\[Psi]", " ", "mw"}], "0", "0", 
        RowBox[{"d\[Sigma]a", " ", "mw", " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], 
        RowBox[{"d\[Psi]", " ", "mw"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" check \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["HMq =", 
   MatrixForm[{{
     0, $CellContext`d\[Sigma]a $CellContext`mw, $CellContext`d\[Psi] \
$CellContext`mw Cos[$CellContext`\[Psi]], 0, 
      0}, {$CellContext`cb^2 $CellContext`d\[Psi] $CellContext`mw, 0, 
      0, $CellContext`d\[Sigma]a $CellContext`mw 
      Cos[$CellContext`\[Psi]], $CellContext`d\[Psi] $CellContext`mw}}], 
   " check ", {0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7772957560782075`*^9, 3.7772957677170444`*^9}, {
   3.7772960553020477`*^9, 3.7772960983925266`*^9}, 3.777310789614789*^9, {
   3.77731138721611*^9, 3.777311464489505*^9}, 3.77739732897396*^9, 
   3.777836575668479*^9, 3.777902109253236*^9, 3.7779801035431895`*^9, {
   3.7779802661497383`*^9, 3.7779802727852793`*^9}, {3.7782417817270193`*^9, 
   3.7782417859680023`*^9}},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"edd2bf4b-d679-40e1-aadc-fa7fe1177985"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"HCgJ =\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "b\[Sigma]"}], " ", "d\[Sigma]a"}], "-", 
         RowBox[{"k\[Sigma]", " ", "\[Sigma]a"}]}], "0", "0", "0"},
       {
        RowBox[{
         RowBox[{
          RowBox[{"-", "b\[Psi]"}], " ", "d\[Psi]"}], "-", 
         RowBox[{"k\[Psi]", " ", "\[Psi]"}]}], "0", "0", 
        RowBox[{
         RowBox[{"-", "d\[Sigma]a"}], " ", "d\[Psi]", " ", "mw", " ", 
         RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" check \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["HCgJ =", 
   MatrixForm[{{
     0, -$CellContext`b\[Sigma] $CellContext`d\[Sigma]a - $CellContext`k\
\[Sigma] $CellContext`\[Sigma]a, 0, 0, 
      0}, {-$CellContext`b\[Psi] $CellContext`d\[Psi] - $CellContext`k\[Psi] \
$CellContext`\[Psi], 0, 
      0, -$CellContext`d\[Sigma]a $CellContext`d\[Psi] $CellContext`mw 
      Sin[$CellContext`\[Psi]], 0}}], " check ", {0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7772957560782075`*^9, 3.7772957677170444`*^9}, {
   3.7772960553020477`*^9, 3.7772960983925266`*^9}, 3.777310789614789*^9, {
   3.77731138721611*^9, 3.777311464489505*^9}, 3.77739732897396*^9, 
   3.777836575668479*^9, 3.777902109253236*^9, 3.7779801035431895`*^9, {
   3.7779802661497383`*^9, 3.7779802727852793`*^9}, {3.7782417817270193`*^9, 
   3.778241785983626*^9}},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"01f25ab3-a1cf-43b0-bc57-1794bfa709ee"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Another", " ", "version", " ", "for", " ", "1", "st", " ", "order", " ", 
     "integration"}], " ", "-", " ", 
    RowBox[{"see", " ", "notes"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"HCgJ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"k\[Sigma]", " ", "\[Sigma]a"}], "+", 
          RowBox[{"b\[Sigma]", " ", "d\[Sigma]a"}]}], ",", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["d\[Psi]", "2"]}], " ", "mw", " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", "0", ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k\[Psi]", " ", "\[Psi]"}], "+", 
          RowBox[{"b\[Psi]", " ", "d\[Psi]"}]}], ",", "0", ",", "0", ",", "0",
          ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CgJ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cc", "+", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{"b\[Sigma]", ",", "b\[Psi]"}], "}"}], "]"}]}], ")"}], ".", 
       "dq"}], "+", "gg"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"MISSING", " ", "J", " ", "F"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<HCgJ =\>\"", ",", 
     RowBox[{"HCgJ", "//", "MatrixForm"}], ",", "\"\< check \>\"", ",", 
     RowBox[{
      RowBox[{"CgJ", "-", 
       RowBox[{"HCgJ", ".", "pb"}]}], "//", "Simplify"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7772955427659225`*^9, 3.7772958056986694`*^9}, {
   3.7772958754757233`*^9, 3.77729587603638*^9}, {3.777295978618245*^9, 
   3.7772960974970765`*^9}, {3.777311351287094*^9, 3.7773114630201364`*^9}, {
   3.7773974523632727`*^9, 3.777397465167469*^9}, 3.7773975027290287`*^9, {
   3.7773975469705877`*^9, 3.777397560657154*^9}, {3.777397963248881*^9, 
   3.777398003344451*^9}, {3.777398051143586*^9, 3.7773980636129756`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"25483ff3-37d1-4a0c-af82-05bbfa7ba266"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"HCgJ =\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{
         RowBox[{"b\[Sigma]", " ", "d\[Sigma]a"}], "+", 
         RowBox[{"k\[Sigma]", " ", "\[Sigma]a"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d\[Psi]", "2"]}], " ", "mw", " ", 
         RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "0", "0"},
       {
        RowBox[{
         RowBox[{"b\[Psi]", " ", "d\[Psi]"}], "+", 
         RowBox[{"k\[Psi]", " ", "\[Psi]"}]}], "0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" check \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["HCgJ =", 
   MatrixForm[{{
     0, $CellContext`b\[Sigma] $CellContext`d\[Sigma]a + $CellContext`k\
\[Sigma] $CellContext`\[Sigma]a, -$CellContext`d\[Psi]^2 $CellContext`mw 
      Sin[$CellContext`\[Psi]], 0, 
      0}, {$CellContext`b\[Psi] $CellContext`d\[Psi] + $CellContext`k\[Psi] \
$CellContext`\[Psi], 0, 0, 0, 0}}], " check ", {0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7772957560782075`*^9, 3.7772957677170444`*^9}, {
   3.7772960553020477`*^9, 3.7772960983925266`*^9}, 3.777310789614789*^9, {
   3.77731138721611*^9, 3.777311464489505*^9}, 3.77739732897396*^9, 
   3.7773975611431847`*^9, {3.777397977365758*^9, 3.777398003914239*^9}, 
   3.777398064403755*^9, 3.7779801036345043`*^9, 3.7779802764812794`*^9, {
   3.77824178223915*^9, 3.7782417860617485`*^9}},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"16d965d5-90aa-4a85-936b-6c44466cfbfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Output coords", "Subsection",
 CellChangeTimes->{{3.7778365394087048`*^9, 
  3.77783654124557*^9}},ExpressionUUID->"ba49d1fe-001f-49d6-8859-\
d54067ef8729"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dq", "=", 
   RowBox[{"{", 
    RowBox[{"d\[Sigma]o", ",", "d\[Psi]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddq", "=", 
   RowBox[{"{", 
    RowBox[{"dd\[Sigma]o", ",", "dd\[Psi]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k\[Sigma]", " ", "\[Sigma]o"}], ",", 
     RowBox[{"k\[Psi]", " ", "\[Psi]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lhs", "=", 
   RowBox[{
    RowBox[{"M", ".", "ddq"}], "+", 
    RowBox[{"Cc", ".", "dq"}], "+", "gg"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "=", 
    RowBox[{"{", 
     RowBox[{"cb", ",", "T"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Did", " ", "this", " ", "by", " ", "hand", " ", "TODO", " ", "automate", 
    " ", "this", " ", "somehow"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Htest", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k\[Sigma]", " ", "\[Sigma]o"}], ",", "0", ",", "dd\[Sigma]o", 
       ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dd\[Psi]", " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "-", 
         RowBox[{
          RowBox[{"d\[Psi]", "^", "2"}], 
          RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ")"}], ",", "0"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k\[Psi]", " ", "\[Psi]"}], ",", "0", ",", "0", ",", 
       RowBox[{"dd\[Sigma]o", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{"2", "dd\[Psi]"}]}], "}"}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "the", " ", "2", "dd\[Psi]", " ", "corresponds", " ", "to", " ", "Iw"}],
       "+", 
      RowBox[{"mw", " ", 
       RowBox[{"cb", "^", "2"}]}]}], "*)"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Htest", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "cb", ",", "mw", ",", 
     RowBox[{"mw", " ", "cb"}], ",", 
     RowBox[{"mw", " ", 
      RowBox[{"cb", "^", "2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lhs", "-", 
   RowBox[{"Htest", ".", "pb"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7771425365648155`*^9, 3.7771426203092065`*^9}, {
  3.777142749924432*^9, 3.777142907520192*^9}, {3.777143613426916*^9, 
  3.7771436469442883`*^9}, {3.777144427755089*^9, 3.7771444483754*^9}, {
  3.777284995631071*^9, 3.7772850397329283`*^9}, {3.7772850749962263`*^9, 
  3.7772851127909656`*^9}, {3.777285157266591*^9, 3.777285274992138*^9}, {
  3.777285317015274*^9, 3.7772853713068604`*^9}, {3.7772854163541384`*^9, 
  3.7772854731521792`*^9}, {3.7772864914658566`*^9, 3.777286503883217*^9}, {
  3.777295819230338*^9, 3.7772958382176557`*^9}, {3.7772958812651596`*^9, 
  3.7772958961290135`*^9}, {3.777295954661989*^9, 3.7772959615397563`*^9}, {
  3.7778365546620717`*^9, 3.7778365815730333`*^9}, {3.777836627039789*^9, 
  3.7778366400787477`*^9}, {3.77783667151435*^9, 3.777836719614107*^9}, {
  3.7779802842277575`*^9, 3.7779804785623384`*^9}, {3.778241795076499*^9, 
  3.7782418025634155`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"7aa9bb97-7ba6-4131-bc3f-425eac7391fb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"k\[Sigma]", " ", "\[Sigma]o"}], "0", "dd\[Sigma]o", 
      RowBox[{
       RowBox[{"dd\[Psi]", " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["d\[Psi]", "2"], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], "0"},
     {
      RowBox[{"k\[Psi]", " ", "\[Psi]"}], "0", "0", 
      RowBox[{"dd\[Sigma]o", " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], 
      RowBox[{"2", " ", "dd\[Psi]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7771426208029013`*^9, {3.7771427899497986`*^9, 3.7771428476120634`*^9}, {
   3.777142884946085*^9, 3.7771429078619814`*^9}, {3.777143613763706*^9, 
   3.777143647333047*^9}, {3.777144428099878*^9, 3.777144448681212*^9}, 
   3.7772849930646515`*^9, {3.77728516055157*^9, 3.777285187980688*^9}, {
   3.777285248590386*^9, 3.777285276126438*^9}, 3.7772853173820496`*^9, 
   3.7772853721033688`*^9, {3.777285436356827*^9, 3.7772854734969654`*^9}, 
   3.7772865042130117`*^9, 3.777295896374861*^9, 3.777295962124394*^9, 
   3.77731078907687*^9, 3.7773973266233587`*^9, 3.777836588153282*^9, {
   3.7778366339002037`*^9, 3.7778366407756767`*^9}, {3.777836678322356*^9, 
   3.777836721027232*^9}, 3.777902114659216*^9, 3.7779801036970024`*^9, {
   3.7779802808769207`*^9, 3.777980285370805*^9}, {3.777980350164764*^9, 
   3.7779803879311843`*^9}, 3.7779804196273203`*^9, {3.777980450777285*^9, 
   3.777980479026239*^9}, {3.778241786141761*^9, 3.7782418046905107`*^9}},
 CellLabel->
  "Out[75]//MatrixForm=",ExpressionUUID->"106d90b4-ee1f-4779-84d2-\
ad4d253b58af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7771426208029013`*^9, {3.7771427899497986`*^9, 3.7771428476120634`*^9}, {
   3.777142884946085*^9, 3.7771429078619814`*^9}, {3.777143613763706*^9, 
   3.777143647333047*^9}, {3.777144428099878*^9, 3.777144448681212*^9}, 
   3.7772849930646515`*^9, {3.77728516055157*^9, 3.777285187980688*^9}, {
   3.777285248590386*^9, 3.777285276126438*^9}, 3.7772853173820496`*^9, 
   3.7772853721033688`*^9, {3.777285436356827*^9, 3.7772854734969654`*^9}, 
   3.7772865042130117`*^9, 3.777295896374861*^9, 3.777295962124394*^9, 
   3.77731078907687*^9, 3.7773973266233587`*^9, 3.777836588153282*^9, {
   3.7778366339002037`*^9, 3.7778366407756767`*^9}, {3.777836678322356*^9, 
   3.777836721027232*^9}, 3.777902114659216*^9, 3.7779801036970024`*^9, {
   3.7779802808769207`*^9, 3.777980285370805*^9}, {3.777980350164764*^9, 
   3.7779803879311843`*^9}, 3.7779804196273203`*^9, {3.777980450777285*^9, 
   3.777980479026239*^9}, {3.778241786141761*^9, 3.7782418046905107`*^9}},
 CellLabel->"Out[77]=",ExpressionUUID->"7617faea-43fd-4f96-b984-1195fc2e87ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"pieces", " ", "from", " ", "notes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Mdq", "=", 
     RowBox[{"M", ".", "dq"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HMq", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "d\[Sigma]o", " ", ",", 
         RowBox[{"d\[Psi]", " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{"d\[Sigma]o", " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
         RowBox[{"2", "d\[Psi]"}]}], "}"}]}], "}"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "the", " ", "2", "dd\[Psi]", " ", "corresponds", " ", "to", " ", "Iw"}],
       "+", 
      RowBox[{"mw", " ", 
       RowBox[{"cb", "^", "2"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<HMq =\>\"", ",", 
      RowBox[{"HMq", "//", "MatrixForm"}], ",", "\"\< check \>\"", ",", 
      RowBox[{
       RowBox[{"Mdq", "-", 
        RowBox[{"HMq", ".", "pb"}]}], "//", "Simplify"}]}], "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"CgJ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cc", "\[Transpose]"}], "-", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"{", 
            RowBox[{"b\[Sigma]", ",", "b\[Psi]"}], "}"}], "]"}]}], ")"}], ".",
         "dq"}], "-", "gg"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"MISSING", " ", "J", " ", "F"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"HCgJ", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "k\[Sigma]"}], " ", "\[Sigma]o"}], "-", 
           RowBox[{"b\[Sigma]", " ", "d\[Sigma]o"}]}], ",", "0", ",", "0", 
          ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "k\[Psi]"}], " ", "\[Psi]"}], "-", 
           RowBox[{"b\[Psi]", " ", "d\[Psi]"}]}], ",", "0", ",", 
          RowBox[{
           RowBox[{"-", " ", "d\[Sigma]o"}], " ", "d\[Psi]", " ", 
           RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", "0"}], "}"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<HCgJ =\>\"", ",", 
       RowBox[{"HCgJ", "//", "MatrixForm"}], ",", "\"\< check \>\"", ",", 
       RowBox[{
        RowBox[{"CgJ", "-", 
         RowBox[{"HCgJ", ".", "pb"}]}], "//", "Simplify"}]}], "]"}]}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Another", " ", "version", " ", "for", " ", "1", "st", " ", "order", " ",
       "integration"}], " ", "-", " ", 
     RowBox[{"see", " ", "notes"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CgJ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cc", "+", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{"b\[Sigma]", ",", "b\[Psi]"}], "}"}], "]"}]}], ")"}], ".", 
       "dq"}], "+", "gg"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"MISSING", " ", "J", " ", "F"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"HCgJ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k\[Sigma]", " ", "\[Sigma]o"}], "+", 
          RowBox[{"b\[Sigma]", " ", "d\[Sigma]o"}]}], ",", "0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["d\[Psi]", "2"]}], " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k\[Psi]", " ", "\[Psi]"}], "+", 
          RowBox[{"b\[Psi]", " ", "d\[Psi]"}]}], ",", "0", ",", "0", ",", "0",
          ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<HCgJ =\>\"", ",", 
     RowBox[{"HCgJ", "//", "MatrixForm"}], ",", "\"\< check \>\"", ",", 
     RowBox[{
      RowBox[{"CgJ", "-", 
       RowBox[{"HCgJ", ".", "pb"}]}], "//", "Simplify"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7772955427659225`*^9, 3.7772958056986694`*^9}, {
   3.7772958754757233`*^9, 3.77729587603638*^9}, {3.777295978618245*^9, 
   3.7772960974970765`*^9}, {3.777311351287094*^9, 3.7773114630201364`*^9}, {
   3.777836803456485*^9, 3.777836860203764*^9}, 3.7779805105680294`*^9, {
   3.7779805420554385`*^9, 3.7779806223942738`*^9}, {3.777980657513428*^9, 
   3.7779806976269145`*^9}, {3.7782418085836687`*^9, 3.778241817920826*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"c77b77c9-a3fe-416b-8aac-b4af2a5d5901"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"HMq =\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "d\[Sigma]o", 
        RowBox[{"d\[Psi]", " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{"d\[Sigma]o", " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], 
        RowBox[{"2", " ", "d\[Psi]"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" check \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["HMq =", 
   MatrixForm[{{
     0, 0, $CellContext`d\[Sigma]o, $CellContext`d\[Psi] 
      Cos[$CellContext`\[Psi]], 0}, {
     0, 0, 0, $CellContext`d\[Sigma]o Cos[$CellContext`\[Psi]], 
      2 $CellContext`d\[Psi]}}], " check ", {0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7772957560782075`*^9, 3.7772957677170444`*^9}, {
   3.7772960553020477`*^9, 3.7772960983925266`*^9}, 3.777310789614789*^9, {
   3.77731138721611*^9, 3.777311464489505*^9}, 3.77739732897396*^9, 
   3.7773975611431847`*^9, {3.777397977365758*^9, 3.777398003914239*^9}, 
   3.777398064403755*^9, 3.7778365764060235`*^9, 3.7778368767495537`*^9, 
   3.777902117530446*^9, 3.7779801038532467`*^9, {3.777980668118572*^9, 
   3.7779806980712943`*^9}, 3.778241786230508*^9, 3.778241820048256*^9},
 CellLabel->
  "During evaluation of \
In[78]:=",ExpressionUUID->"80d7544e-04fb-405c-a49b-e82f8463fd42"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"HCgJ =\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"b\[Sigma]", " ", "d\[Sigma]o"}], "+", 
         RowBox[{"k\[Sigma]", " ", "\[Sigma]o"}]}], "0", "0", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d\[Psi]", "2"]}], " ", 
         RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "0"},
       {
        RowBox[{
         RowBox[{"b\[Psi]", " ", "d\[Psi]"}], "+", 
         RowBox[{"k\[Psi]", " ", "\[Psi]"}]}], "0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" check \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["HCgJ =", 
   MatrixForm[{{$CellContext`b\[Sigma] $CellContext`d\[Sigma]o + \
$CellContext`k\[Sigma] $CellContext`\[Sigma]o, 0, 0, -$CellContext`d\[Psi]^2 
      Sin[$CellContext`\[Psi]], 
      0}, {$CellContext`b\[Psi] $CellContext`d\[Psi] + $CellContext`k\[Psi] \
$CellContext`\[Psi], 0, 0, 0, 0}}], " check ", {0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7772957560782075`*^9, 3.7772957677170444`*^9}, {
   3.7772960553020477`*^9, 3.7772960983925266`*^9}, 3.777310789614789*^9, {
   3.77731138721611*^9, 3.777311464489505*^9}, 3.77739732897396*^9, 
   3.7773975611431847`*^9, {3.777397977365758*^9, 3.777398003914239*^9}, 
   3.777398064403755*^9, 3.7778365764060235`*^9, 3.7778368767495537`*^9, 
   3.777902117530446*^9, 3.7779801038532467`*^9, {3.777980668118572*^9, 
   3.7779806980712943`*^9}, 3.778241786230508*^9, 3.778241820063878*^9},
 CellLabel->
  "During evaluation of \
In[78]:=",ExpressionUUID->"24e176cd-6c5d-44d0-917f-600deea8905e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["With reflected actuator properties", "Subsection",
 CellChangeTimes->{{3.777902350177533*^9, 
  3.7779023570797734`*^9}},ExpressionUUID->"90591deb-1b9b-4fdb-a71d-\
4db995bd93ae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MdqT", "=", 
   RowBox[{"Mdq", "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ma", "/", 
        RowBox[{"\[Tau]", "^", "2"}]}], " ", "d\[Sigma]o"}], ",", "0"}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pbt", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"pb", ",", 
     RowBox[{"{", 
      RowBox[{"1", "/", 
       RowBox[{"\[Tau]", "^", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HMqT", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"HMq", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ma", " ", "d\[Sigma]o"}], "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], "}"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<HMqT =\>\"", ",", 
    RowBox[{"HMqT", "//", "MatrixForm"}], ",", "\"\< check \>\"", ",", 
    RowBox[{
     RowBox[{"MdqT", "-", 
      RowBox[{"HMqT", ".", "pbt"}]}], "//", "Simplify"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"1", "st", " ", "order"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CgJT", "=", 
   RowBox[{"CgJ", "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ba", "/", 
         RowBox[{"\[Tau]", "^", "2"}]}], " ", "d\[Sigma]o"}], "+", 
       RowBox[{
        RowBox[{"ka", "/", 
         RowBox[{"\[Tau]", "^", "2"}]}], " ", "\[Sigma]o"}]}], ",", "0"}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HCgJT", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"HCgJ", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ba", " ", "d\[Sigma]o"}], "+", 
           RowBox[{"ka", " ", "\[Sigma]o"}]}], "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], "}"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<HCgJ =\>\"", ",", 
   RowBox[{"HCgJT", "//", "MatrixForm"}], ",", "\"\< check \>\"", ",", 
   RowBox[{
    RowBox[{"CgJT", "-", 
     RowBox[{"HCgJT", ".", "pbt"}]}], "//", "Simplify"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7779034763922434`*^9, 3.777903554187532*^9}, {
  3.777903829219517*^9, 3.7779041744760504`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"b926fc41-44d8-4c47-9da6-c1aff1c4432c"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"HMqT =\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "d\[Sigma]o", 
        RowBox[{"d\[Psi]", " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "0", 
        RowBox[{"d\[Sigma]o", " ", "ma"}]},
       {"0", "0", "0", 
        RowBox[{"d\[Sigma]o", " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], 
        RowBox[{"2", " ", "d\[Psi]"}], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" check \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["HMqT =", 
   MatrixForm[{{
     0, 0, $CellContext`d\[Sigma]o, $CellContext`d\[Psi] 
      Cos[$CellContext`\[Psi]], 0, $CellContext`d\[Sigma]o $CellContext`ma}, {
     0, 0, 0, $CellContext`d\[Sigma]o Cos[$CellContext`\[Psi]], 
      2 $CellContext`d\[Psi], 0}}], " check ", {0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7779038629144278`*^9, {3.7779039786102247`*^9, 3.777904015511706*^9}, {
   3.7779041301712866`*^9, 3.777904142423106*^9}, 3.7779041750149813`*^9, 
   3.7779801039313707`*^9, 3.777980706324438*^9, 3.7782417863134575`*^9, 
   3.778241822815372*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"3c406439-9dce-4e13-85d2-fa3725450b46"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"HCgJ =\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"b\[Sigma]", " ", "d\[Sigma]o"}], "+", 
         RowBox[{"k\[Sigma]", " ", "\[Sigma]o"}]}], "0", "0", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d\[Psi]", "2"]}], " ", 
         RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "0", 
        RowBox[{
         RowBox[{"ba", " ", "d\[Sigma]o"}], "+", 
         RowBox[{"ka", " ", "\[Sigma]o"}]}]},
       {
        RowBox[{
         RowBox[{"b\[Psi]", " ", "d\[Psi]"}], "+", 
         RowBox[{"k\[Psi]", " ", "\[Psi]"}]}], "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" check \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}],
  SequenceForm["HCgJ =", 
   MatrixForm[{{$CellContext`b\[Sigma] $CellContext`d\[Sigma]o + \
$CellContext`k\[Sigma] $CellContext`\[Sigma]o, 0, 0, -$CellContext`d\[Psi]^2 
      Sin[$CellContext`\[Psi]], 
      0, $CellContext`ba $CellContext`d\[Sigma]o + $CellContext`ka \
$CellContext`\[Sigma]o}, {$CellContext`b\[Psi] $CellContext`d\[Psi] + \
$CellContext`k\[Psi] $CellContext`\[Psi], 0, 0, 0, 0, 0}}], " check ", {0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7779038629144278`*^9, {3.7779039786102247`*^9, 3.777904015511706*^9}, {
   3.7779041301712866`*^9, 3.777904142423106*^9}, 3.7779041750149813`*^9, 
   3.7779801039313707`*^9, 3.777980706324438*^9, 3.7782417863134575`*^9, 
   3.7782418228309965`*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"872f3dca-e17a-4837-9ff2-9f6aeae99c99"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Kevin paper", "Section",
 CellChangeTimes->{{3.778248339517721*^9, 
  3.778248343542597*^9}},ExpressionUUID->"266d956c-d7dc-4dcb-bec8-\
76f22d115302"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"c16Tab1", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"spar", " ", "width", " ", 
        RowBox[{"(", "mm", ")"}]}], "*)"}], " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.14", ",", " ", "0.17", ",", " ", "0.20", ",", " ", "0.23", ",", 
         " ", "0.26", ",", " ", "0.29"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Ixx", 
         RowBox[{"(", 
          RowBox[{"mg", "\[CenterDot]", "mm2"}], ")"}]}], "*)"}], " ", 
       RowBox[{"{", 
        RowBox[{
        "1.91", ",", " ", "2.25", ",", " ", "2.56", ",", " ", "2.90", ",", 
         " ", "3.27", ",", " ", "3.64"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Izz", 
         RowBox[{"(", 
          RowBox[{"mg", "\[CenterDot]", "mm2"}], ")"}]}], "*)"}], " ", 
       RowBox[{"{", 
        RowBox[{
        "40.6", ",", " ", "48.8", ",", " ", "57.2", ",", " ", "65.6", ",", 
         " ", "73.4", ",", " ", "82.7"}], "}"}]}], "}"}], "\[Transpose]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Try", " ", "to", " ", "predict", " ", "based", " ", "on", " ", "some", 
    " ", "density"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Chen", " ", "2016", " ", "JFM", " ", 
     RowBox[{"paper", ":", " ", 
      RowBox[{"The", " ", "wing", " ", "weighs", " ", "0.52", " ", "mg"}]}]}],
     ",", 
    RowBox[{
     RowBox[{
     "has", " ", "a", " ", "wing", " ", "span", " ", "of", " ", "12.8", " ", 
      "mm", " ", "and", " ", "a", " ", "surface", " ", "area", " ", "of", " ",
       "54", " ", 
      RowBox[{"mm2", ".", "The"}], " ", "origin", " ", "of", " ", "the", " ", 
      "coordinate", " ", "system", " ", "is", " ", "located", " ", "at", " ", 
      "the", " ", "wing", " ", "tip", " ", "leading", " ", 
      RowBox[{"edge", ".", "The"}], " ", "centre", " ", "of", " ", "mass", 
      " ", "is", " ", "located", " ", "at", " ", "x"}], "=", 
     RowBox[{"3.41", " ", "mm"}]}], ",", 
    RowBox[{"y", "=", 
     RowBox[{
      RowBox[{"\[Minus]", "0.52"}], " ", "mm"}]}], ",", 
    RowBox[{"z", "=", 
     RowBox[{
      RowBox[{"\[Minus]", "0.04"}], " ", 
      RowBox[{"mm", ".", "The"}], " ", "moments", " ", "of", " ", "inertia", 
      " ", "Ixx"}]}], ",", 
    RowBox[{
    "Iyy", " ", "and", " ", "Izz", " ", "with", " ", "respect", " ", "to", 
     " ", "the", " ", "centre", " ", "of", " ", "mass", " ", "are", " ", 
     "1.54"}], ",", 
    RowBox[{"18.78", " ", "and", " ", "20.0", " ", "mg", " ", "mm2"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"IPredict", "=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dspar", "=", 
         RowBox[{"c16Tab1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"ar", "=", "54"}], ",", "\[Rho]mem"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"dspar", ",", 
        RowBox[{"0.2", "+", 
         RowBox[{"11.5", "dspar"}]}], ",", 
        RowBox[{"290", "dspar"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "c16Tab1", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPointPlot3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c16Tab1", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", ";;"}], "]"}], "]"}], ",", "IPredict"}], "}"}], ",", 
   RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<spar width (mm)\>\"", ",", "\"\<Ixx(mg\[CenterDot]mm2)\>\"", ",", 
      "\"\<Izz(mg\[CenterDot]mm2)\>\""}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7782483486810527`*^9, 3.778248628687231*^9}, {
   3.778248670668059*^9, 3.778248725108776*^9}, {3.7782496662725706`*^9, 
   3.778249692517024*^9}, {3.7782512123349657`*^9, 3.778251329105486*^9}, {
   3.778251693059292*^9, 3.7782516955354633`*^9}, 3.778258237328906*^9, {
   3.778268107477532*^9, 3.7782681521047316`*^9}, {3.7782681878746004`*^9, 
   3.7782683208229523`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"3707860e-6ab3-49d3-a85b-4b356600ba5c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.14`", ",", "1.81`", ",", "40.6`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.17`", ",", "2.1550000000000002`", ",", "49.300000000000004`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2`", ",", "2.5000000000000004`", ",", "58.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.23`", ",", "2.845`", ",", "66.7`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.26`", ",", "3.1900000000000004`", ",", "75.4`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.29`", ",", "3.535`", ",", "84.1`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.778258237700673*^9, {3.7782682089640064`*^9, 3.7782683211615095`*^9}},
 CellLabel->"Out[93]=",ExpressionUUID->"ab6396bc-d297-43e3-85fe-ac1745be591a"],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[0.3315753, 0.4561011, 0.6388182], PointSize[
     NCache[
      Rational[7, 360], 0.019444444444444445`]], 
    Point3DBox[{{0.14, 1.91, 40.6}, {0.17, 2.25, 48.8}, {0.2, 2.56, 57.2}, {
     0.23, 2.9, 65.6}, {0.26, 3.27, 73.4}, {0.29, 3.64, 82.7}}]}, 
   {RGBColor[0.7926498, 0.5499369, 0.1278459], PointSize[
     NCache[
      Rational[7, 360], 0.019444444444444445`]], 
    Point3DBox[{{0.14, 1.81, 40.6}, {0.17, 2.1550000000000002`, 
     49.300000000000004`}, {0.2, 2.5000000000000004`, 58.}, {0.23, 2.845, 
     66.7}, {0.26, 3.1900000000000004`, 75.4}, {0.29, 3.535, 84.1}}]}, 
   {RGBColor[0.3315753, 0.4561011, 0.6388182], Opacity[0.3], 
    Line3DBox[{{{0.14, 1.91, 40.6}, {0.14, 1.91, 40.6}}, {{0.17, 2.25, 
     48.8}, {0.17, 2.25, 40.6}}, {{0.2, 2.56, 57.2}, {0.2, 2.56, 40.6}}, {{
     0.23, 2.9, 65.6}, {0.23, 2.9, 40.6}}, {{0.26, 3.27, 73.4}, {0.26, 3.27, 
     40.6}}, {{0.29, 3.64, 82.7}, {0.29, 3.64, 40.6}}}]}, 
   {RGBColor[0.7926498, 0.5499369, 0.1278459], Opacity[0.3], 
    Line3DBox[{{{0.14, 1.81, 40.6}, {0.14, 1.81, 40.6}}, {{0.17, 
     2.1550000000000002`, 49.300000000000004`}, {0.17, 2.1550000000000002`, 
     40.6}}, {{0.2, 2.5000000000000004`, 58.}, {0.2, 2.5000000000000004`, 
     40.6}}, {{0.23, 2.845, 66.7}, {0.23, 2.845, 40.6}}, {{0.26, 
     3.1900000000000004`, 75.4}, {0.26, 3.1900000000000004`, 40.6}}, {{0.29, 
     3.535, 84.1}, {0.29, 3.535, 40.6}}}]}},
  Axes->True,
  AxesLabel->{
    FormBox["\"spar width (mm)\"", TraditionalForm], 
    FormBox["\"Ixx(mg\[CenterDot]mm2)\"", TraditionalForm], 
    FormBox["\"Izz(mg\[CenterDot]mm2)\"", TraditionalForm]},
  BoxRatios->{1, 1, 0.4},
  DisplayFunction->Identity,
  FaceGrids->None,
  FaceGridsStyle->Automatic,
  ImageSize->{340.23334983930187`, 328.4724263859398},
  ImageSizeRaw->Automatic,
  PlotRange->{{0.14, 0.29}, {1.81, 3.64}, Automatic},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic, Automatic},
  ViewPoint->{1.8987532005888885`, -0.42375507902958065`, 2.768603965223284},
  ViewVertical->{-0.12733535392034956`, 0.043495971706510206`, 
   0.9909055495289578}]], "Output",
 CellChangeTimes->{
  3.778258237700673*^9, {3.7782682089640064`*^9, 3.778268321229921*^9}},
 CellLabel->"Out[94]=",ExpressionUUID->"f791e6ab-4565-4d55-8e4f-9bee8e6d75aa"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1278, 1348},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4581, 126, 444, "Input",ExpressionUUID->"6b59dfce-cc25-4d57-9081-6bccd44f02c9"],
Cell[5164, 150, 1497, 28, 44, "Output",ExpressionUUID->"07e5fb6f-3e52-4dc9-92d6-fb57031d60a8"],
Cell[6664, 180, 2021, 45, 81, "Output",ExpressionUUID->"50f5c4bc-98b0-4ab3-9994-6f8594724e57"],
Cell[8688, 227, 1941, 44, 78, "Output",ExpressionUUID->"121a8581-f272-4763-a9d5-d4f1dc1ae726"],
Cell[10632, 273, 1169, 21, 44, "Output",ExpressionUUID->"840940f6-5b46-4579-b253-cd5aedaa062e"],
Cell[11804, 296, 2057, 49, 85, "Output",ExpressionUUID->"f365aae1-697a-4973-b770-ba0d2cec8ef5"],
Cell[13864, 347, 957, 17, 40, "Output",ExpressionUUID->"dd5e1ef8-539b-41f0-9e50-61f5227a2c69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14858, 369, 2913, 79, 180, "Input",ExpressionUUID->"e907f1af-bbb5-418e-9307-0e8120f51a63"],
Cell[CellGroupData[{
Cell[17796, 452, 1962, 46, 47, "Print",ExpressionUUID->"edd2bf4b-d679-40e1-aadc-fa7fe1177985"],
Cell[19761, 500, 2060, 49, 44, "Print",ExpressionUUID->"01f25ab3-a1cf-43b0-bc57-1794bfa709ee"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21870, 555, 2151, 54, 113, "Input",ExpressionUUID->"25483ff3-37d1-4a0c-af82-05bbfa7ba266"],
Cell[24024, 611, 2011, 47, 47, "Print",ExpressionUUID->"16d965d5-90aa-4a85-936b-6c44466cfbfa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26072, 663, 162, 3, 67, "Subsection",ExpressionUUID->"ba49d1fe-001f-49d6-8859-d54067ef8729"],
Cell[CellGroupData[{
Cell[26259, 670, 3381, 86, 324, "Input",ExpressionUUID->"7aa9bb97-7ba6-4131-bc3f-425eac7391fb"],
Cell[29643, 758, 2005, 43, 78, "Output",ExpressionUUID->"106d90b4-ee1f-4779-84d2-ad4d253b58af"],
Cell[31651, 803, 1139, 17, 40, "Output",ExpressionUUID->"7617faea-43fd-4f96-b984-1195fc2e87ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32827, 825, 4868, 127, 357, "Input",ExpressionUUID->"c77b77c9-a3fe-416b-8aac-b4af2a5d5901"],
Cell[CellGroupData[{
Cell[37720, 956, 1823, 42, 44, "Print",ExpressionUUID->"80d7544e-04fb-405c-a49b-e82f8463fd42"],
Cell[39546, 1000, 2073, 47, 47, "Print",ExpressionUUID->"24e176cd-6c5d-44d0-917f-600deea8905e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41680, 1054, 184, 3, 67, "Subsection",ExpressionUUID->"90591deb-1b9b-4fdb-a71d-4db995bd93ae"],
Cell[CellGroupData[{
Cell[41889, 1061, 2456, 75, 204, "Input",ExpressionUUID->"b926fc41-44d8-4c47-9da6-c1aff1c4432c"],
Cell[CellGroupData[{
Cell[44370, 1140, 1679, 41, 44, "Print",ExpressionUUID->"3c406439-9dce-4e13-85d2-fa3725450b46"],
Cell[46052, 1183, 2041, 49, 47, "Print",ExpressionUUID->"872f3dca-e17a-4837-9ff2-9f6aeae99c99"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48154, 1239, 161, 3, 83, "Section",ExpressionUUID->"266d956c-d7dc-4dcb-bec8-76f22d115302"],
Cell[CellGroupData[{
Cell[48340, 1246, 4382, 109, 348, "Input",ExpressionUUID->"3707860e-6ab3-49d3-a85b-4b356600ba5c"],
Cell[52725, 1357, 774, 18, 40, "Output",ExpressionUUID->"ab6396bc-d297-43e3-85fe-ac1745be591a"],
Cell[53502, 1377, 2396, 48, 432, "Output",ExpressionUUID->"f791e6ab-4565-4d55-8e4f-9bee8e6d75aa"]
}, Open  ]]
}, Open  ]]
}
]
*)

